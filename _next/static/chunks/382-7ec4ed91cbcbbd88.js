"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[382,3415],{12857:(t,e,o)=>{o.d(e,{H1:()=>u,SM:()=>i,US:()=>s,getAllProviders:()=>r,h1:()=>l});var a=o(98120),n=o(83415);async function r(){try{return(await (0,n.P7)()||[]).map(t=>({...t,enabled:t.isEnabled}))}catch(t){return console.error("Failed to get providers:",t),[]}}async function s(t){try{let e=await (0,n.Dr)(t);if(!e)return null;return{...e,enabled:e.isEnabled}}catch(e){return console.error("Failed to get provider ".concat(t,":"),e),null}}async function u(t){try{let e=(0,a.F6)();if(!e)return console.error("No user ID found, cannot save provider"),!1;let o={...t,isEnabled:t.enabled,userId:e};return await (0,n.Uu)(o),!0}catch(t){return console.error("Failed to save provider:",t),!1}}async function l(t){try{return await (0,n.Ge)(t),!0}catch(e){return console.error("Failed to delete provider ".concat(t,":"),e),!1}}async function i(){return(await r()).filter(t=>t.enabled).map(t=>({id:"provider-model-".concat(t.id),name:"".concat(t.name," - ").concat(t.model),modelName:t.model,providerName:t.name,providerId:t.id}))}},54420:(t,e,o)=>{o.d(e,{cG:()=>i,ml:()=>l,oE:()=>s});var a=o(98120),n=o(91502);let r={enableDataStreamUsage:!0};async function s(){try{let t=(0,a.F6)();if(!t)return r;let e=await (0,n.oE)(t);if(!e)return r;return{...r,...e}}catch(t){return console.error("Failed to get user preferences:",t),r}}async function u(t){try{let e=(0,a.F6)();if(!e)throw Error("No user ID found");let o={userId:e,...t,createdAt:new Date().toISOString()};return await (0,n.bM)(o),!0}catch(t){return console.error("Failed to save user preferences:",t),!1}}async function l(t){return(await s())[t]}async function i(t,e){let o={...await s(),[t]:e};return await u(o)}},68320:(t,e,o)=>{o.d(e,{Go:()=>c,Z_:()=>d});var a=o(54420),n=o(91502),r=o(98120);let s=null,u={"gpt-4o":{inputCostPerToken:5e-6,outputCostPerToken:15e-6},"gpt-4-turbo":{inputCostPerToken:1e-5,outputCostPerToken:3e-5},"gpt-4":{inputCostPerToken:3e-5,outputCostPerToken:6e-5},"gpt-3.5-turbo":{inputCostPerToken:5e-7,outputCostPerToken:15e-7},"claude-3-opus-20240229":{inputCostPerToken:15e-6,outputCostPerToken:75e-6},"claude-3-sonnet-20240229":{inputCostPerToken:3e-6,outputCostPerToken:15e-6},"claude-3-haiku-20240307":{inputCostPerToken:25e-8,outputCostPerToken:125e-8},"gemini-2.5-flash":{inputCostPerToken:75e-9,outputCostPerToken:3e-7},"gemini-1.5-pro":{inputCostPerToken:35e-8,outputCostPerToken:105e-8},"gemini-1.5-flash":{inputCostPerToken:375e-10,outputCostPerToken:15e-8},"gemini-1.0-pro":{inputCostPerToken:5e-8,outputCostPerToken:15e-8},"mistral-large-latest":{inputCostPerToken:2e-6,outputCostPerToken:6e-6},"mistral-medium-latest":{inputCostPerToken:27e-8,outputCostPerToken:81e-8},"mistral-small-latest":{inputCostPerToken:2e-8,outputCostPerToken:6e-8},llama3:{inputCostPerToken:0,outputCostPerToken:0},llama2:{inputCostPerToken:0,outputCostPerToken:0},mistral:{inputCostPerToken:0,outputCostPerToken:0}};async function l(t,e,o){if(!await (0,a.ml)("enableDataStreamUsage"))return;let l=e+o,i=u[t]||{inputCostPerToken:0,outputCostPerToken:0},c=e*i.inputCostPerToken+o*i.outputCostPerToken;s||(s={totalRequests:0,totalInputTokens:0,totalOutputTokens:0,totalTokens:0,totalCost:0,byModel:{}}),s.totalRequests+=1,s.totalInputTokens+=e,s.totalOutputTokens+=o,s.totalTokens+=l,s.totalCost+=c,s.byModel[t]||(s.byModel[t]={requests:0,inputTokens:0,outputTokens:0,tokens:0,cost:0}),s.byModel[t].requests+=1,s.byModel[t].inputTokens+=e,s.byModel[t].outputTokens+=o,s.byModel[t].tokens+=l,s.byModel[t].cost+=c;let d=(0,r.F6)();d&&await (0,n.So)(d,s),console.log("Recorded usage for model ".concat(t,": ").concat(e," input tokens, ").concat(o," output tokens"))}function i(){s={totalRequests:0,totalInputTokens:0,totalOutputTokens:0,totalTokens:0,totalCost:0,byModel:{}},console.log("Usage statistics reset")}let c={recordModelUsage:l,getUsageStats:async function t(){let t=(0,r.F6)();if(t){let e=await (0,n.DY)(t);(null==e?void 0:e.usageStats)&&(s=e.usageStats)}return s||(s={totalRequests:0,totalInputTokens:0,totalOutputTokens:0,totalTokens:0,totalCost:0,byModel:{}}),{...s}},resetUsageStats:i},d={recordModelUsage:(t,e,o)=>{l(t,e,o).catch(t=>{console.error("Error recording model usage:",t)})},getUsageStats:()=>({...s||{totalRequests:0,totalInputTokens:0,totalOutputTokens:0,totalTokens:0,totalCost:0,byModel:{}}}),resetUsageStats:i}},83415:(t,e,o)=>{o.d(e,{CE:()=>i,Dr:()=>T,Ge:()=>f,JH:()=>u,Lz:()=>l,P7:()=>w,Uu:()=>k,_L:()=>r.ry,bd:()=>r.gY,getLocalMessagesByChatId:()=>c,saveLocalChat:()=>s,saveLocalMessages:()=>d,si:()=>p});var a=o(98120),n=o(97229),r=o(91502);async function s(t){let{id:e,userId:o,title:a}=t;try{return await (0,r.xW)({id:e,userId:o,title:a})}catch(t){throw console.error("Error in saveLocalChat:",t),new n.P7("bad_request:database","Failed to save chat")}}async function u(t){let{userId:e}=t;try{let t=await (0,r.W2)(e);if(0===t.length)return{deletedCount:0};for(let e of t)await (0,r.L0)(e.id);return{deletedCount:t.length}}catch(t){throw new n.P7("bad_request:database","Failed to delete all chats by user id")}}async function l(t){let{id:e,limit:o,startingAfter:a,endingBefore:s}=t;try{let t=(await (0,r.W2)(e)).sort((t,e)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()),u=t;if(a){let e=t.find(t=>t.id===a);if(!e)throw new n.P7("not_found:database","Chat with id ".concat(a," not found"));u=t.filter(t=>new Date(t.createdAt).getTime()>new Date(e.createdAt).getTime())}else if(s){let e=t.find(t=>t.id===s);if(!e)throw new n.P7("not_found:database","Chat with id ".concat(s," not found"));u=t.filter(t=>new Date(t.createdAt).getTime()<new Date(e.createdAt).getTime())}let l=u.length>o;return{chats:l?u.slice(0,o):u,hasMore:l}}catch(t){throw new n.P7("bad_request:database","Failed to get chats by user id")}}async function i(t){let{id:e}=t;try{let t=await (0,r.getLocalChat)(e);if(!t)return null;return t}catch(t){throw new n.P7("bad_request:database","Failed to get chat by id")}}async function c(t){let{id:e}=t;try{return await (0,r.Em)(e)}catch(t){throw new n.P7("bad_request:database","Failed to get messages by chat id")}}async function d(t){let{messages:e}=t;try{if(0===e.length)return!0;let t=e[0].chatId;return await (0,r.b4)(t,e)}catch(t){throw new n.P7("bad_request:database","Failed to save messages")}}async function p(t){let{id:e}=t;try{return await (0,r.BP)(e)}catch(t){throw new n.P7("bad_request:database","Failed to get suggestions by document id")}}async function k(t){try{return await (0,r.aP)(t)}catch(t){throw new n.P7("bad_request:database","Failed to save provider")}}async function w(){try{let t=(0,a.F6)();if(!t)return[];return await (0,r.f5)(t)}catch(t){throw new n.P7("bad_request:database","Failed to get providers")}}async function T(t){try{return await (0,r.rC)(t)}catch(t){throw new n.P7("bad_request:database","Failed to get provider")}}async function f(t){try{return await (0,r.OG)(t)}catch(t){throw new n.P7("bad_request:database","Failed to delete provider")}}o(63045)}}]);