"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3415],{83415:(t,e,a)=>{a.d(e,{CE:()=>o,Dr:()=>f,Ge:()=>y,JH:()=>d,Lz:()=>s,P7:()=>b,Uu:()=>h,_L:()=>i.ry,bd:()=>i.gY,getLocalMessagesByChatId:()=>u,saveLocalChat:()=>c,saveLocalMessages:()=>l,si:()=>w});var r=a(98120),n=a(97229),i=a(91502);async function c(t){let{id:e,userId:a,title:r}=t;try{return await (0,i.xW)({id:e,userId:a,title:r})}catch(t){throw console.error("Error in saveLocalChat:",t),new n.P7("bad_request:database","Failed to save chat")}}async function d(t){let{userId:e}=t;try{let t=await (0,i.W2)(e);if(0===t.length)return{deletedCount:0};for(let e of t)await (0,i.L0)(e.id);return{deletedCount:t.length}}catch(t){throw new n.P7("bad_request:database","Failed to delete all chats by user id")}}async function s(t){let{id:e,limit:a,startingAfter:r,endingBefore:c}=t;try{let t=(await (0,i.W2)(e)).sort((t,e)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()),d=t;if(r){let e=t.find(t=>t.id===r);if(!e)throw new n.P7("not_found:database","Chat with id ".concat(r," not found"));d=t.filter(t=>new Date(t.createdAt).getTime()>new Date(e.createdAt).getTime())}else if(c){let e=t.find(t=>t.id===c);if(!e)throw new n.P7("not_found:database","Chat with id ".concat(c," not found"));d=t.filter(t=>new Date(t.createdAt).getTime()<new Date(e.createdAt).getTime())}let s=d.length>a;return{chats:s?d.slice(0,a):d,hasMore:s}}catch(t){throw new n.P7("bad_request:database","Failed to get chats by user id")}}async function o(t){let{id:e}=t;try{let t=await (0,i.getLocalChat)(e);if(!t)return null;return t}catch(t){throw new n.P7("bad_request:database","Failed to get chat by id")}}async function u(t){let{id:e}=t;try{return await (0,i.Em)(e)}catch(t){throw new n.P7("bad_request:database","Failed to get messages by chat id")}}async function l(t){let{messages:e}=t;try{if(0===e.length)return!0;let t=e[0].chatId;return await (0,i.b4)(t,e)}catch(t){throw new n.P7("bad_request:database","Failed to save messages")}}async function w(t){let{id:e}=t;try{return await (0,i.BP)(e)}catch(t){throw new n.P7("bad_request:database","Failed to get suggestions by document id")}}async function h(t){try{return await (0,i.aP)(t)}catch(t){throw new n.P7("bad_request:database","Failed to save provider")}}async function b(){try{let t=(0,r.F6)();if(!t)return[];return await (0,i.f5)(t)}catch(t){throw new n.P7("bad_request:database","Failed to get providers")}}async function f(t){try{return await (0,i.rC)(t)}catch(t){throw new n.P7("bad_request:database","Failed to get provider")}}async function y(t){try{return await (0,i.OG)(t)}catch(t){throw new n.P7("bad_request:database","Failed to delete provider")}}a(63045)}}]);