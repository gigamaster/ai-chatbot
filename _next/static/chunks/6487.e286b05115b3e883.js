"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6487],{66087:(t,e,n)=>{n.d(e,{_6:()=>U}),"stream"in Blob.prototype||Object.defineProperty(Blob.prototype,"stream",{value(){return new Response(this).body}}),"setBigUint64"in DataView.prototype||Object.defineProperty(DataView.prototype,"setBigUint64",{value(t,e,n){let i=Number(4294967295n&e),o=Number(e>>32n);this.setUint32(t+4*!n,i,n),this.setUint32(t+4*!!n,o,n)}});var i=t=>new DataView(new ArrayBuffer(t)),o=t=>new Uint8Array(t.buffer||t),r=t=>(new TextEncoder).encode(String(t)),a=t=>Math.min(0xffffffff,Number(t)),s=t=>Math.min(65535,Number(t));function l(t,e=t){return new ReadableStream({async pull(e){let n=0;for(;e.desiredSize>n;){let a=await t.next();if(!a.value){e.close();break}{var i;let t="string"==typeof(i=a.value)?r(i):i instanceof Uint8Array?i:o(i);e.enqueue(t),n+=t.byteLength}}},cancel(t){e.throw?.(t)}})}function c(t,e,n){var i,a;let[s,l]=e?e instanceof Uint8Array?[e,1]:ArrayBuffer.isView(e)||e instanceof ArrayBuffer?[o(e),1]:[r(e),0]:[void 0,0];if(t instanceof File)return{i:d(s||r(t.name)),o:BigInt(t.size),u:l};if(t instanceof Response){let e=t.headers.get("content-disposition"),i=e&&e.match(/;\s*filename\*?\s*=\s*(?:UTF-\d+''|)["']?([^;"'\r\n]*)["']?(?:;|$)/i),o=i&&i[1]||t.url&&new URL(t.url).pathname.split("/").findLast(Boolean),a=o&&decodeURIComponent(o),c=n||+t.headers.get("content-length");return{i:d(s||r(a)),o:BigInt(c),u:l}}return s=d(s,void 0!==t||void 0!==n),"string"==typeof t?{i:s,o:BigInt(r(t).length),u:l}:t instanceof Blob?{i:s,o:BigInt(t.size),u:l}:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?{i:s,o:BigInt(t.byteLength),u:l}:{i:s,o:(i=t,(a=n)>-1?BigInt(a):i?void 0:0n),u:l}}function d(t,e=1){if(!t||t.every(t=>47===t))throw Error("The file must have a name.");if(e)for(;47===t[t.length-1];)t=t.subarray(0,-1);else 47!==t[t.length-1]&&(t=new Uint8Array([...t,47]));return t}var f=new Uint32Array(256);for(let t=0;t<256;++t){let e=t;for(let t=0;t<8;++t)e=e>>>1^(1&e&&0xedb88320);f[t]=e}function u(t,e=0){e=~e;for(var n=0,i=t.length;n<i;n++)e=e>>>8^f[255&e^t[n]];return~e>>>0}function p(t,e,n=0){let i=t.getSeconds()>>1|t.getMinutes()<<5|t.getHours()<<11,o=t.getDate()|t.getMonth()+1<<5|t.getFullYear()-1980<<9;e.setUint16(n,i,1),e.setUint16(n+2,o,1)}var g=new TextDecoder("utf8",{fatal:1});async function*y(t){let{bytes:e}=t;if("then"in e&&(e=await e),e instanceof Uint8Array)yield e,t.l=u(e,0),t.o=BigInt(e.length);else{t.o=0n;let n=e.getReader();for(;;){let{value:e,done:i}=await n.read();if(i)break;t.l=u(e,t.l),t.o+=BigInt(e.length),yield e}}}function m(t){return t instanceof File||t instanceof Response?[[t],[t]]:[[t.input,t.name,t.size],[t.input,t.lastModified,t.mode]]}var h=t=>(function(t){let e=BigInt(22),n=0n,i=0;for(let o of t){if(!o.i)throw Error("Every file must have a non-empty name.");if(void 0===o.o)throw Error(`Missing size for file "${(new TextDecoder).decode(o.i)}".`);let t=o.o>=4294967295n,r=n>=4294967295n;n+=BigInt(46+o.i.length+(t&&8))+o.o,e+=BigInt(o.i.length+46+(12*r|28*t)),i||(i=t)}return(i||n>=4294967295n)&&(e+=BigInt(76)),e+n})(function*(t){for(let e of t)yield c(...m(e)[0])}(t));function U(t,e={}){let n={"Content-Type":"application/zip","Content-Disposition":"attachment"};return("bigint"==typeof e.length||Number.isInteger(e.length))&&e.length>0&&(n["Content-Length"]=String(e.length)),e.metadata&&(n["Content-Length"]=String(h(e.metadata))),new Response(function(t,e={}){let n=function(t){let e=t[Symbol.iterator in t?Symbol.iterator:Symbol.asyncIterator]();return{async next(){let t=await e.next();if(t.done)return t;let[n,i]=m(t.value);return{done:0,value:Object.assign(function(t,e,n){void 0===e||e instanceof Date||(e=new Date(e));let i=void 0!==t;if(n||(n=i?436:509),t instanceof File)return{isFile:i,t:e||new Date(t.lastModified),bytes:t.stream(),mode:n};if(t instanceof Response)return{isFile:i,t:e||new Date(t.headers.get("Last-Modified")||Date.now()),bytes:t.body,mode:n};if(void 0===e)e=new Date;else if(isNaN(e))throw Error("Invalid modification date.");if(!i)return{isFile:i,t:e,mode:n};if("string"==typeof t)return{isFile:i,t:e,bytes:r(t),mode:n};if(t instanceof Blob)return{isFile:i,t:e,bytes:t.stream(),mode:n};if(t instanceof Uint8Array||t instanceof ReadableStream)return{isFile:i,t:e,bytes:t,mode:n};if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return{isFile:i,t:e,bytes:o(t),mode:n};if(Symbol.asyncIterator in t)return{isFile:i,t:e,bytes:l(t[Symbol.asyncIterator]()),mode:n};throw TypeError("Unsupported input format.")}(...i),c(...n))}},throw:e.throw?.bind(e),[Symbol.asyncIterator](){return this}}}(t);return l(async function*(t,e){let n=[],r=0n,l=0n,c=0;for await(let s of t){let t=function({i:t,u:e},n){return 8*(!e||(n??function(t){try{g.decode(t)}catch{return 0}return 1}(t)))}(s,e.buffersAreUTF8);yield function(t,e=0){let n=i(30);return n.setUint32(0,0x504b0304),n.setUint32(4,0x2d000800|e),p(t.t,n,10),n.setUint16(26,t.i.length,1),o(n)}(s,t),yield new Uint8Array(s.i),s.isFile&&(yield*y(s));let d=s.o>=4294967295n,f=12*(r>=4294967295n)|28*d;yield function(t,e){let n=i(16+8*!!e);return n.setUint32(0,0x504b0708),n.setUint32(4,t.isFile?t.l:0,1),e?(n.setBigUint64(8,t.o,1),n.setBigUint64(16,t.o,1)):(n.setUint32(8,a(t.o),1),n.setUint32(12,a(t.o),1)),o(n)}(s,d),n.push(function(t,e,n=0,r=0){let s=i(46);return s.setUint32(0,0x504b0102),s.setUint32(4,0x2d032d00),s.setUint16(8,2048|n),p(t.t,s,12),s.setUint32(16,t.isFile?t.l:0,1),s.setUint32(20,a(t.o),1),s.setUint32(24,a(t.o),1),s.setUint16(28,t.i.length,1),s.setUint16(30,r,1),s.setUint16(40,t.mode|(t.isFile?32768:16384),1),s.setUint32(42,a(e),1),o(s)}(s,r,t,f)),n.push(s.i),f&&n.push(function(t,e,n){let r=i(n);return r.setUint16(0,1,1),r.setUint16(2,n-4,1),16&n&&(r.setBigUint64(4,t.o,1),r.setBigUint64(12,t.o,1)),r.setBigUint64(n-8,e,1),o(r)}(s,r,f)),d&&(r+=8n),l++,r+=BigInt(46+s.i.length)+s.o,c||(c=d)}let d=0n;for(let t of n)yield t,d+=BigInt(t.length);if(c||r>=4294967295n){let t=i(76);t.setUint32(0,0x504b0606),t.setBigUint64(4,BigInt(44),1),t.setUint32(12,0x2d032d00),t.setBigUint64(24,l,1),t.setBigUint64(32,l,1),t.setBigUint64(40,d,1),t.setBigUint64(48,r,1),t.setUint32(56,0x504b0607),t.setBigUint64(64,r+d,1),t.setUint32(72,1,1),yield o(t)}let f=i(22);f.setUint32(0,0x504b0506),f.setUint16(8,s(l),1),f.setUint16(10,s(l),1),f.setUint32(12,a(d),1),f.setUint32(16,a(r),1),yield o(f)}(n,e),n)}(t,e),{headers:n})}},96487:(t,e,n)=>{n.r(e),n.d(e,{download:()=>s,downloadBlob:()=>l,exportAsJson:()=>o,exportAsMarkdown:()=>r,exportAsText:()=>a,exportChat:()=>d,exportChatAsZip:()=>f,generateFilename:()=>c});var i=n(66087);function o(t){return JSON.stringify(t,null,2)}function r(t){let e="# ".concat(t.title,"\n\n");for(let i of(e+="Exported on: ".concat(t.exportedAt.toISOString(),"\n\n"),t.messages)){var n;let t="user"===i.role?"User":"Assistant",o=(null==(n=i.metadata)?void 0:n.createdAt)||"";e+="## ".concat(t).concat(o?" (".concat(o,")"):"","\n");let r=i.parts.filter(t=>"text"===t.type).map(t=>t.text).join("\n\n");e+="".concat(r,"\n\n")}return e+="---\n",e+="Chat ID: ".concat(t.id,"\n")}function a(t){let e="Chat: ".concat(t.title,"\n");for(let i of(e+="Exported on: ".concat(t.exportedAt.toISOString(),"\n"),e+="Chat ID: ".concat(t.id,"\n"),e+="\n".concat("=".repeat(50),"\n\n"),t.messages)){var n;let t="user"===i.role?"User":"Assistant",o=(null==(n=i.metadata)?void 0:n.createdAt)||"";e+="".concat(t).concat(o?" (".concat(o,")"):"",":\n");let r=i.parts.filter(t=>"text"===t.type).map(t=>t.text).join("\n\n");e+="".concat(r,"\n\n")}return e}function s(t,e,n){let i=new Blob([t],{type:n}),o=URL.createObjectURL(i),r=document.createElement("a");r.href=o,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(o)}function l(t,e){let n=URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)}function c(t,e){let n=t.replace(/[^a-z0-9]/gi,"_").toLowerCase().substring(0,50),i=new Date().toISOString().split("T")[0];return"".concat(n,"_").concat(i,".").concat({json:"json",markdown:"md",text:"txt"}[e])}function d(t,e,n){let i,l,d,f={id:t.id,title:t.title,createdAt:t.createdAt,messages:e,exportedAt:new Date};switch(n){case"json":i=o(f),l=c(t.title,"json"),d="application/json";break;case"markdown":i=r(f),l=c(t.title,"markdown"),d="text/markdown";break;case"text":i=a(f),l=c(t.title,"text"),d="text/plain";break;default:throw Error("Unsupported export format: ".concat(n))}s(i,l,d)}async function f(t,e){try{let n={id:t.id,title:t.title,createdAt:t.createdAt,messages:e,exportedAt:new Date},s=[{name:"".concat(c(t.title,"json")),lastModified:new Date,input:o(n)},{name:"".concat(c(t.title,"markdown")),lastModified:new Date,input:r(n)},{name:"".concat(c(t.title,"text")),lastModified:new Date,input:a(n)}],d=await (0,i._6)(s).blob(),f="".concat(t.title.replace(/[^a-z0-9]/gi,"_").toLowerCase().substring(0,50),"_").concat(new Date().toISOString().split("T")[0],".zip");l(d,f)}catch(t){throw console.error("Failed to export chat as ZIP:",t),Error("Failed to export chat as ZIP")}}}}]);